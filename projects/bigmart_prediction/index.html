<!DOCTYPE html>
<html lang="en">

<head>
  <title>
  Prediction Model for BigMart Product Sales · Pei-Han
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="Pei-Han">
<meta name="description" content="A">
<meta name="keywords" content="blog,developer,personal">



  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Prediction Model for BigMart Product Sales">
  <meta name="twitter:description" content="A">

<meta property="og:url" content="http://hsu-ph.github.io/projects/bigmart_prediction/">
  <meta property="og:site_name" content="Pei-Han">
  <meta property="og:title" content="Prediction Model for BigMart Product Sales">
  <meta property="og:description" content="A">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="projects">
    <meta property="article:published_time" content="2023-12-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2023-12-07T00:00:00+00:00">
    <meta property="article:tag" content="Python">
    <meta property="article:tag" content="Slide-Project">




<link rel="canonical" href="http://hsu-ph.github.io/projects/bigmart_prediction/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.min.aa5ef26fa979d6793724ae2dbd71efa94fd16cb1c5c7db3b6651f21f9892a5fd.css" integrity="sha256-ql7yb6l51nk3JK4tvXHvqU/RbLHFx9s7ZlHyH5iSpf0=" crossorigin="anonymous" media="screen" />






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.min.a00e6364bacbc8266ad1cc81230774a1397198f8cfb7bcba29b7d6fcb54ce57f.css" integrity="sha256-oA5jZLrLyCZq0cyBIwd0oTlxmPjPt7y6KbfW/LVM5X8=" crossorigin="anonymous" media="screen" />
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.svg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://hsu-ph.github.io/">
      Pei-Han
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">About</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">Blog</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/projects/">Projects</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/contact/">Contact me</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="http://hsu-ph.github.io/projects/bigmart_prediction/">
          Prediction Model for BigMart Product Sales
        </a>
      </h1>
    </header>

    <h2 id="project-overview">
  <strong>Project Overview</strong>
  <a class="heading-link" href="#project-overview">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>As we manage a company, we not only have to produce products, but also we need to understand the sales status of each type of product in different regions, different channels, and additional merchants, which enhances the importance of analyzing datasets. Therefore, the project will analyze different tiers, types of products, and areas and build models to predict sales.</p>
<h2 id="key-question">
  <strong>Key Question</strong>
  <a class="heading-link" href="#key-question">
    <i class="fa-solid fa-link" aria-hidden="true" title="Link to heading"></i>
    <span class="sr-only">Link to heading</span>
  </a>
</h2>
<p>Depending on several factors (Reviews, Price, Location, etc.) to predict the ranking of the property.</p>
<ul>
<li>Show total sales in each outlet</li>
<li>Predict the sales of different item types in each outlet next time</li>
<li>Show total sales in each tier</li>
<li>Predict the sales of different item types in each tier(location) next time</li>
<li>Analyzing sales in different types of store</li>
<li>Help the store owner find the problems</li>
</ul>
<ol>
<li>Show total sales in each outlet
![totalSales](/images/1-1total sales.JPG)</li>
<li>Predict the sales of different item types in each outlet next time</li>
</ol>
<p>![2item](/images/1-2item types.JPG)
3. Using pie chart to appear the proportion of the sales of different item type in each outlet.
![1different](/images/1-2-1different item type.JPG)</p>
<hr>
<ol start="4">
<li>Predict the sales of different item types in each outlet next time</li>
</ol>
<pre tabindex="0"><code>X_1 = pd.get_dummies(df_sort_IdItemType[[&#39;Outlet_Identifier&#39;, &#39;Item_Type&#39;]], columns=[&#39;Outlet_Identifier&#39;, &#39;Item_Type&#39;])
Y_1 = df_sort_IdItemType[&#39;Item_Outlet_Sales&#39;]

# Split data to training and test set
X_train_1, X_test_1, Y_train_1, Y_test_1 = train_test_split(X_1, Y_1, test_size=0.4, random_state=42)

# Remove features which don&#39;t match the training set or the test set
extraFeatureTrain = set(X_train_1.columns) - set(X_test_1.columns)
extraFeatureTest = set(X_test_1.columns) - set(X_train_1.columns)
X_train_1 = X_train_1.drop(columns=extraFeatureTrain)
X_test_1 = X_test_1.drop(columns=extraFeatureTest)

# Build KNN regressor model
knnRModel = KNeighborsRegressor(n_neighbors=5)

knnRModel.fit(X_train_1, Y_train_1)

Y_pred_1 = knnRModel.predict(X_test_1)
Y_pred_1
</code></pre><hr>
<pre tabindex="0"><code>p_data1 = pd.DataFrame(index=pd.MultiIndex.from_product([l_OutId, l_ItemType], names=[&#39;Outlet_Identifier&#39;, &#39;Item_Type&#39;]))

p_data_encoded_1 = pd.get_dummies(p_data1.reset_index(), columns=[ &#39;Item_Type&#39;,&#39;Outlet_Identifier&#39;])

common_features_1 = list(set(X_train_1.columns) &amp; set(p_data_encoded_1.columns))
p_data_encoded_1 = p_data_encoded_1[common_features_1]

p_sales = knnRegressor.predict(p_data_encoded_1)

p_data1[&#39;Predicted_Sales&#39;] = p_sales
#p_data
</code></pre><ol start="5">
<li>
<p>Using bar chart to appear the predicted price of different item types in each outlet next time.
![different](/images/2-4 different item types.JPG)</p>
</li>
<li>
<p>Total sales in each tier
![3Total](/images/3Total sale.JPG)</p>
</li>
<li>
<p>Predict the sales of different item types in each tier(location) next time</p>
</li>
</ol>
<hr>
<pre tabindex="0"><code>X_4 = pd.get_dummies(df_sort_LocItemType[[&#39;Outlet_Location_Type&#39;, &#39;Item_Type&#39;]], columns=[&#39;Outlet_Location_Type&#39;, &#39;Item_Type&#39;])
Y_4 = df_sort_LocItemType[&#39;Item_Outlet_Sales&#39;]

# Split training set and test set
X_train_4, X_test_4, Y_train_4, Y_test_4 = train_test_split(X_4, Y_4, test_size=0.3, random_state=42)

# Remove features that do not match between the training set and the test set
extra_FeatureTrain_4 = set(X_train_4.columns) - set(X_test_4.columns)
extra_FeatureTest_4 = set(X_test_4.columns) - set(X_train_4.columns)
X_train_4 = X_train_4.drop(columns=extra_FeatureTrain_4)
X_test_4 = X_test_4.drop(columns=extra_FeatureTest_4)

# Build KNN regressor model
knnModel = KNeighborsRegressor(n_neighbors=5)

knnModel.fit(X_train_4, Y_train_4)

Y_pred_4 = knnModel.predict(X_test_4)
Y_pred_4
</code></pre><hr>
<pre tabindex="0"><code>p_data_Location_4 = pd.DataFrame(index=pd.MultiIndex.from_product([l_LocId, l_ItemType], names=[&#39;Outlet_Location_Type&#39;, &#39;Item_Type&#39;]))

p_data_encoded_4 = pd.get_dummies(p_data_Location_4.reset_index(), columns=[ &#39;Item_Type&#39;,&#39;Outlet_Location_Type&#39;])

common_features_4 = list(set(X_train_4.columns) &amp; set(p_data_encoded_4.columns))

# Ensure that only the columns used during the training phase are used for prediction
p_data_encoded_4 = p_data_encoded_4.reindex(columns=X_train_4.columns, fill_value=0)

# Make predictions
p_sales_Location = knnModel.predict(p_data_encoded_4)

# Add predictions to the DataFrame
p_data_Location_4[&#39;Predicted_Sales&#39;] = p_sales_Location

p_data_Location_4
</code></pre><pre tabindex="0"><code>with pm.Model() as Store_Compare_regression_model:
    Item_MRP = pm.Data(&#34;Item_MRP&#34;, Store_Compare_models[&#34;Item_MRP&#34;])
    Item_Outlet_Sales = pm.Data(&#34;Item_Outlet_Sales&#34;, Store_Compare_models[&#34;Item_Outlet_Sales&#34;])
    Item_Visibility = pm.Data(&#34;Item_Visibility&#34;, Store_Compare_models[&#34;Item_Visibility&#34;])
    Low_Fat = pm.Data(&#34;Low_Fat&#34;, Store_Compare_models[&#34;Low Fat&#34;])
    Regular = pm.Data(&#34;Regular&#34;, Store_Compare_models[&#34;Regular&#34;])
    Tier_1 = pm.Data(&#34;Tier_1&#34;, Store_Compare_models[&#34;Tier 1&#34;])
    Tier_2 = pm.Data(&#34;Tier_2&#34;, Store_Compare_models[&#34;Tier 2&#34;])
    Tier_3 = pm.Data(&#34;Tier_3&#34;, Store_Compare_models[&#34;Tier 3&#34;])
    
    # priors
    beta_i = pm.Normal(&#34;beta_i&#34;, mu=0, sigma=1)
    beta_Item_MRP = pm.Normal(&#34;beta_Item_MRP&#34;, mu=0, sigma=1)
    beta_Item_Outlet_Sales= pm.Normal(&#34;beta_Item_Outlet_Sales&#34;, mu=0, sigma=1)
    beta_Item_Visibility = pm.Normal(&#34;beta_Item_Visibility&#34;, mu=0, sigma=1)
    beta_Low_Fat = pm.Normal(&#34;beta_Low_Fat&#34;, mu=0, sigma=1)
    beta_Regular = pm.Normal(&#34;beta_Regular&#34;, mu=0, sigma=1)
    beta_Tier_1 = pm.Normal(&#34;beta_Tier_1&#34;, mu=0, sigma=1)
    beta_Tier_2 = pm.Normal(&#34;beta_Tier_2&#34;, mu=0, sigma=1)
    beta_Tier_3 = pm.Normal(&#34;beta_Tier_3&#34;, mu=0, sigma=1)
    
    # linear model
    mu = beta_i + beta_Item_MRP * Item_MRP + beta_Item_Outlet_Sales * Item_Outlet_Sales + beta_Item_Visibility * Item_Visibility + beta_Low_Fat * Low_Fat + beta_Regular * Regular + beta_Tier_1 * Tier_1 + beta_Tier_2 * Tier_2 +beta_Tier_3 * Tier_3
    p = pm.Deterministic(&#34;p&#34;, pm.math.invlogit(mu))
    
    # likelihood
    pm.Bernoulli(&#34;WL&#34;, p=p, observed=Store_Compare_models[&#34;Item_Outlet_Sales&#34;])
</code></pre>
  </article>
</section>

  

    </div>

    <footer class="footer">
  <section class="container">
    ©
    
      2022 -
    
    2024
     Pei-Han 
    ·
    
    Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.min.6ae284be93d2d19dad1f02b0039508d9aab3180a12a06dcc71b0b0ef7825a317.js" integrity="sha256-auKEvpPS0Z2tHwKwA5UI2aqzGAoSoG3McbCw73gloxc="></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
